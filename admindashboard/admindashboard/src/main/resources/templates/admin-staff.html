<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Staff Directory | WhiteCircle Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f6f9; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

        .navbar-custom { background-color: #1e3a8a; height: 85px; }
        .btn-dashboard-back {
            color: white; background-color: transparent; border: 1px solid white;
            border-radius: 4px; padding: 6px 15px; font-size: 0.85rem; font-weight: 500;
            text-decoration: none; display: inline-flex; align-items: center; transition: all 0.2s ease;
        }
        .btn-dashboard-back:hover { background-color: rgba(255, 255, 255, 0.1); color: white; }

        .content-card { background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); overflow: hidden; }
        .table thead th { background-color: #f8f9fa; color: #495057; font-weight: 600; text-transform: uppercase; font-size: 0.85rem; border-bottom: 2px solid #e9ecef; }
        .avatar-circle { width: 35px; height: 35px; background-color: #e9ecef; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #495057; font-weight: bold; font-size: 0.9rem; margin-right: 10px; }
        .status-badge { padding: 5px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .status-active { background-color: #e6fcf5; color: #0ca678; }

        /* Search Box Polish */
        .search-box-container { max-width: 300px; }
        .form-control:focus { box-shadow: none; border-color: #1e3c72; }

       /* Custom style for the Edit button - Dark Blue Theme */
        .btn-edit-custom {
            background-color: #1e3a8a; /* Dark blue matching your top bar */
            border-color: #1e3a8a;
            color: #ffffff; /* White icon for visibility */
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Hover effect: Slightly darker blue, bigger shadow, slight lift */
        .btn-edit-custom:hover {
            background-color: #152a66; /* Darker blue on hover */
            border-color: #112356;
            color: #ffffff; /* Keep icon white on hover */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        /* Click effect: "Pressed" look with an inner shadow */
        .btn-edit-custom:active {
            background-color: #0f1e4a; /* Even darker blue when clicked */
            border-color: #0b1738;
            color: #ffffff;
            box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.2);
            transform: translateY(0);
        }
    </style>
</head>
<body>

<nav class="navbar navbar-custom navbar-dark sticky-top mb-3" style="background-color: #1e3c72; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
    <div class="container-fluid px-4">

        <span class="navbar-brand mb-0 h1 fw-bold">
            <i class="fas fa-users me-2"></i> Staff Directory
        </span>

        <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show shadow-sm" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            <span th:text="${successMessage}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <a href="/admin/dashboard" class="btn btn-outline-light btn-sm">
            <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
        </a>

    </div>
</nav>

<div class="container-fluid px-4">

    <div class="row mb-4 align-items-center">
        <div class="col-12"> <h4 class="fw-bold text-secondary mb-0">Active Staff Members</h4>
            <p class="text-muted small mb-0">View details of all registered employees.</p>
        </div>
    </div>

    <div class="content-card">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead>
                <tr>
                    <th class="ps-4">Employee</th>
                    <th>Designation</th>
                    <th>Department</th>
                    <th>Email</th>
                    <th>Mobile</th>
                    <th>Location</th>
                    <th>Status</th>
                    <th class="text-end pe-4">Actions</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${#lists.isEmpty(staffList)}">
                    <td colspan="8" class="text-center py-5 text-muted">
                        <i class="fas fa-user-slash fa-2x mb-3 opacity-50"></i>
                        <p>No staff members found matching your search.</p>
                    </td>
                </tr>

                <tr th:each="emp : ${staffList}">
                    <td class="ps-4">
                        <div class="d-flex align-items-center">
                            <div class="avatar-circle">
                                <span th:text="${#strings.substring(emp.fullName,0,1)}">A</span>
                            </div>
                            <div>
                                <div class="fw-bold text-dark" th:text="${emp.fullName}">Name</div>
                                <div class="small text-muted" th:text="${emp.username}">ID</div>
                            </div>
                        </div>
                    </td>

                    <td th:text="${emp.designation != null ? emp.designation : '-'}">Role</td>
                    <td th:text="${emp.businessUnit != null ? emp.businessUnit : '-'}">Dept</td>
                    <td>
                        <a th:href="'mailto:' + ${emp.email}" class="text-decoration-none text-secondary small">
                            <i class="far fa-envelope me-1"></i> <span th:text="${emp.email}"></span>
                        </a>
                    </td>
                    <td th:text="${emp.mobileNumber != null ? emp.mobileNumber : '-'}">Mobile</td>
                    <td th:text="${emp.city != null ? emp.city : '-'}">City</td>

                    <td>
                            <span class="status-badge status-active">
                                <i class="fas fa-circle fa-xs me-1"></i>Active
                            </span>
                    </td>

                    <td class="text-end pe-4">
                        <button class="btn btn-sm btn-outline-primary"
                                title="View Profile"
                                data-bs-toggle="modal"
                                data-bs-target="#employeeModal"
                                th:data-name="${emp.fullName}"
                                th:data-id="${emp.username}"
                                th:data-role="${emp.designation}"
                                th:data-email="${emp.email}"
                                th:data-mobile="${emp.mobileNumber}"
                                th:data-dept="${emp.businessUnit}"
                                th:data-project="${emp.projectName != null ? emp.projectName : 'Unassigned'}"
                                th:data-manager="${emp.reportingManager != null ? emp.reportingManager : 'N/A'}"
                                th:data-exp="${emp.experience != null ? emp.experience : '0 Years'}"
                                th:data-location="${emp.workLocation}"
                                th:data-joining="${emp.joiningDate}">
                            <i class="fas fa-eye"></i>
                        </button>
                        <a th:href="@{/admin/staff/edit/{id}(id=${emp.id})}"
                           class="btn btn-sm btn-edit-custom ms-2"
                           title="Edit Profile">
                            <i class="fas fa-edit"></i>
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="modal fade" id="employeeModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg"> <div class="modal-content border-0 shadow-lg" style="border-radius: 15px;">

        <div class="modal-header text-white" style="background-color: #1e3c72; border-radius: 15px 15px 0 0;">
            <div class="d-flex align-items-center">
                <div class="bg-white text-primary rounded-circle d-flex align-items-center justify-content-center me-3"
                     style="width: 50px; height: 50px; font-weight: bold; font-size: 1.2rem;">
                    <i class="fas fa-user"></i>
                </div>
                <div>
                    <h5 class="modal-title fw-bold mb-0" id="modalName">Employee Name</h5>
                    <small class="opacity-75" id="modalId">EMP ID</small>
                </div>
            </div>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body p-4">
            <div class="row g-4">

                <div class="col-md-6 border-end">
                    <h6 class="text-primary fw-bold mb-3"><i class="fas fa-briefcase me-2"></i>Work Profile</h6>

                    <div class="mb-3">
                        <label class="small text-muted fw-bold">Designation</label>
                        <div class="fw-bold text-dark" id="modalRole">-</div>
                    </div>
                    <div class="mb-3">
                        <label class="small text-muted fw-bold">Department / BU</label>
                        <div id="modalDept">-</div>
                    </div>
                    <div class="mb-3">
                        <label class="small text-muted fw-bold">Current Project</label>
                        <div class="badge bg-light text-dark border px-2 py-1" id="modalProject">-</div>
                    </div>
                    <div class="mb-0">
                        <label class="small text-muted fw-bold">Reporting Manager</label>
                        <div class="text-primary" id="modalManager">-</div>
                    </div>
                </div>

                <div class="col-md-6 ps-md-4">
                    <h6 class="text-success fw-bold mb-3"><i class="fas fa-address-card me-2"></i>Personal Details</h6>

                    <div class="mb-3">
                        <label class="small text-muted fw-bold">Official Email</label>
                        <div><i class="far fa-envelope me-2 text-muted"></i><span id="modalEmail">-</span></div>
                    </div>
                    <div class="mb-3">
                        <label class="small text-muted fw-bold">Contact Number</label>
                        <div><i class="fas fa-phone-alt me-2 text-muted"></i><span id="modalMobile">-</span></div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-6">
                            <div class="p-2 bg-light rounded text-center">
                                <small class="text-muted d-block">Experience</small>
                                <span class="fw-bold text-dark" id="modalExp">-</span>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-2 bg-light rounded text-center">
                                <small class="text-muted d-block">Location</small>
                                <span class="fw-bold text-dark" id="modalLocation">-</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="modal-footer bg-light border-0 justify-content-between">
            <small class="text-muted">Joined on: <span class="fw-bold" id="modalJoining">-</span></small>
            <button type="button" class="btn btn-secondary btn-sm px-4" data-bs-dismiss="modal">Close</button>
        </div>
    </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const employeeModal = document.getElementById('employeeModal');

    employeeModal.addEventListener('show.bs.modal', function (event) {
        // 1. Find the button that triggered the modal
        const button = event.relatedTarget;

        // 2. Extract info from data-* attributes
        const name = button.getAttribute('data-name');
        const id = button.getAttribute('data-id');
        const role = button.getAttribute('data-role');
        const email = button.getAttribute('data-email');
        const mobile = button.getAttribute('data-mobile');
        const dept = button.getAttribute('data-dept');
        const project = button.getAttribute('data-project');
        const manager = button.getAttribute('data-manager');
        const exp = button.getAttribute('data-exp');
        const location = button.getAttribute('data-location');
        const joining = button.getAttribute('data-joining');

        // 3. Update the Modal's content
        document.getElementById('modalName').textContent = name;
        document.getElementById('modalId').textContent = id;
        document.getElementById('modalRole').textContent = role;
        document.getElementById('modalEmail').textContent = email;
        document.getElementById('modalMobile').textContent = mobile;
        document.getElementById('modalDept').textContent = dept;
        document.getElementById('modalProject').textContent = project;
        document.getElementById('modalManager').textContent = manager;
        document.getElementById('modalExp').textContent = exp;
        document.getElementById('modalLocation').textContent = location;
        document.getElementById('modalJoining').textContent = joining;
    });
</script>

</body>
</html>